[
    {
        "cve": "CVE-2024-26865",
        "created_datetime": "2024-04-26T10:36:39",
        "author_id": "544294122",
        "data_id": "1783807397871657084",
        "reposts": 0,
        "post": "@mo124121 cve-2024-26865\n\u3067\u3059\u306d\u3000\u3053\u306e\u524d\u306euse after free\u306e\u3084\u3064(\u756a\u53f7\u5fd8\u308c\u307e\u3057\u305f)\u306b\u8fd1\u3044\u3063\u307d\u3044\u3067\u3059\uff1f",
        "audience": 662,
        "audience_total": 662,
        "total_reposts": 0,
        "post_count": 1,
        "author": "\u304d\u3061\u3053\u26a1\uff8a\uff9f\uff6f\uff8a\uff9f",
        "username": "matukiti_k",
        "v_score": null,
        "e_score": null,
        "base_score": null,
        "description": "IN THE LINUX KERNEL, THE FOLLOWING VULNERABILITY HAS BEEN RESOLVED:\n\nRDS: TCP: FIX USE-AFTER-FREE OF NET IN REQSK_TIMER_HANDLER().\n\nSYZKALLER REPORTED A WARNING OF NETNS TRACKER [0] FOLLOWED BY KASAN\nSPLAT [1] AND ANOTHER REF TRACKER WARNING [1].\n\nSYZKALLER COULD NOT FIND A REPRO, BUT IN THE LOG, THE ONLY SUSPICIOUS\nSEQUENCE WAS AS FOLLOWS:\n\n  18:26:22 EXECUTING PROGRAM 1:\n  R0 = SOCKET$INET6_MPTCP(0XA, 0X1, 0X106)\n  ...\n  CONNECT$INET6(R0, &(0X7F0000000080)={0XA, 0X4001, 0X0, @LOOPBACK}, 0X1C) (ASYNC)\n\nTHE NOTABLE THING HERE IS 0X4001 IN CONNECT(), WHICH IS RDS_TCP_PORT.\n\nSO, THE SCENARIO WOULD BE:\n\n  1. UNSHARE(CLONE_NEWNET) CREATES A PER NETNS TCP LISTENER IN\n      RDS_TCP_LISTEN_INIT().\n  2. SYZ-EXECUTOR CONNECT()S TO IT AND CREATES A REQSK.\n  3. SYZ-EXECUTOR EXIT()S IMMEDIATELY.\n  4. NETNS IS DISMANTLED.  [0]\n  5. REQSK TIMER IS FIRED, AND UAF HAPPENS WHILE FREEING REQSK.  [1]\n  6. LISTENER IS FREED AFTER RCU GRACE PERIOD.  [2]\n\nBASICALLY, REQSK ASSUMES THAT THE LISTENER GUARANTEES NETNS SAFETY\nUNTIL ALL REQSK TIMERS ARE EXPIRED BY HOLDING THE LISTENERS REFCOUNT.\nHOWEVER, THIS WAS NOT THE CASE FOR KERNEL SOCKETS.\n\nCOMMIT 740EA3C4A0B2 (TCP: CLEAN UP KERNEL LISTENERS REQSK IN\nINET_TWSK_PURGE()) FIXED THIS ISSUE ONLY FOR PER-NETNS EHASH.\n\nLETS APPLY THE SAME FIX FOR THE GLOBAL EHASH.\n\n[0]:\nREF_TRACKER: NET NOTREFCNT@0000000065449CC3 HAS 1/1 USERS AT\n     SK_ALLOC (./INCLUDE/NET/NET_NAMESPACE.H:337 NET/CORE/SOCK.C:2146)\n     INET6_CREATE (NET/IPV6/AF_INET6.C:192 NET/IPV6/AF_INET6.C:119)\n     __SOCK_CREATE (NET/SOCKET.C:1572)\n     RDS_TCP_LISTEN_INIT (NET/RDS/TCP_LISTEN.C:279)\n     RDS_TCP_INIT_NET (NET/RDS/TCP.C:577)\n     OPS_INIT (NET/CORE/NET_NAMESPACE.C:137)\n     SETUP_NET (NET/CORE/NET_NAMESPACE.C:340)\n     COPY_NET_NS (NET/CORE/NET_NAMESPACE.C:497)\n     CREATE_NEW_NAMESPACES (KERNEL/NSPROXY.C:110)\n     UNSHARE_NSPROXY_NAMESPACES (KERNEL/NSPROXY.C:228 (DISCRIMINATOR 4))\n     KSYS_UNSHARE (KERNEL/FORK.C:3429)\n     __X64_SYS_UNSHARE (KERNEL/FORK.C:3496)\n     DO_SYSCALL_64 (ARCH/X86/ENTRY/COMMON.C:52 ARCH/X86/ENTRY/COMMON.C:83)\n     ENTRY_SYSCALL_64_AFTER_HWFRAME (ARCH/X86/ENTRY/ENTRY_64.S:129)\n...\nWARNING: CPU: 0 PID: 27 AT LIB/REF_TRACKER.C:179 REF_TRACKER_DIR_EXIT (LIB/REF_TRACKER.C:179)\n\n[1]:\nBUG: KASAN: SLAB-USE-AFTER-FREE IN INET_CSK_REQSK_QUEUE_DROP (./INCLUDE/NET/INET_HASHTABLES.H:180 NET/IPV4/INET_CONNECTION_SOCK.C:952 NET/IPV4/INET_CONNECTION_SOCK.C:966)\nREAD OF SIZE 8 AT ADDR FFFF88801B370400 BY TASK SWAPPER/0/0\nHARDWARE NAME: QEMU STANDARD PC (I440FX + PIIX, 1996), BIOS REL-1.16.0-0-GD239552CE722-PREBUILT.QEMU.ORG 04/01/2014\nCALL TRACE:\n <IRQ>\n DUMP_STACK_LVL (LIB/DUMP_STACK.C:107 (DISCRIMINATOR 1))\n PRINT_REPORT (MM/KASAN/REPORT.C:378 MM/KASAN/REPORT.C:488)\n KASAN_REPORT (MM/KASAN/REPORT.C:603)\n INET_CSK_REQSK_QUEUE_DROP (./INCLUDE/NET/INET_HASHTABLES.H:180 NET/IPV4/INET_CONNECTION_SOCK.C:952 NET/IPV4/INET_CONNECTION_SOCK.C:966)\n REQSK_TIMER_HANDLER (NET/IPV4/INET_CONNECTION_SOCK.C:979 NET/IPV4/INET_CONNECTION_SOCK.C:1092)\n CALL_TIMER_FN (./ARCH/X86/INCLUDE/ASM/JUMP_LABEL.H:27 ./INCLUDE/LINUX/JUMP_LABEL.H:207 ./INCLUDE/TRACE/EVENTS/TIMER.H:127 KERNEL/TIME/TIMER.C:1701)\n __RUN_TIMERS.PART.0 (KERNEL/TIME/TIMER.C:1752 KERNEL/TIME/TIMER.C:2038)\n RUN_TIMER_SOFTIRQ (KERNEL/TIME/TIMER.C:2053)\n __DO_SOFTIRQ (./ARCH/X86/INCLUDE/ASM/JUMP_LABEL.H:27 ./INCLUDE/LINUX/JUMP_LABEL.H:207 ./INCLUDE/TRACE/EVENTS/IRQ.H:142 KERNEL/SOFTIRQ.C:554)\n IRQ_EXIT_RCU (KERNEL/SOFTIRQ.C:427 KERNEL/SOFTIRQ.C:632 KERNEL/SOFTIRQ.C:644)\n SYSVEC_APIC_TIMER_INTERRUPT (ARCH/X86/KERNEL/APIC/APIC.C:1076 (DISCRIMINATOR 14))\n </IRQ>\n\nALLOCATED BY TASK 258 ON CPU 0 AT 83.612050S:\n KASAN_SAVE_STACK (MM/KASAN/COMMON.C:48)\n KASAN_SAVE_TRACK (MM/KASAN/COMMON.C:68)\n __KASAN_SLAB_ALLOC (MM/KASAN/COMMON.C:343)\n KMEM_CACHE_ALLOC (MM/SLUB.C:3813 MM/SLUB.C:3860 MM/SLUB.C:3867)\n COPY_NET_NS (./INCLUDE/LINUX/SLAB.H:701 NET/CORE/NET_NAMESPACE.C:421 NET/CORE/NET_NAMESPACE.C:480)\n CREATE_NEW_NAMESPACES (KERNEL/NSPROXY.C:110)\n UNSHARE_NSPROXY_NAME\n---TRUNCATED---",
        "last_modified_datetime": "2024-04-17 12:48:00",
        "published_datetime": "2024-04-17 11:15:00",
        "vendor_logo": null,
        "profile_url": null,
        "feed_name": "twitter"
    }
]